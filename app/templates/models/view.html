{% extends "base.html" %}
{% block title %}{{ model.working_name }} · Model Details · Payroll Desk{% endblock %}
{% block content %}
<section class="page-header">
    <div>
        <h1 class="page-title">{{ model.working_name }}</h1>
        <p>View-only model details</p>
    </div>
    <div>
        <a class="button secondary" href="/models">Back to Roster</a>
    </div>
</section>

<section class="card" style="max-width: 820px;">
    <h2>Model Information</h2>
    
    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Status</label>
        <div style="padding: 8px 0; font-weight: 500;">
            {% if model.status == 'Active' %}
                <span class="tag active">Active</span>
            {% else %}
                <span class="tag inactive">Inactive</span>
            {% endif %}
        </div>
    </div>

    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Code</label>
        <div style="padding: 8px 0; font-weight: 500;">{{ model.code }}</div>
    </div>

    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Real Name</label>
        <div style="padding: 8px 0; font-weight: 500;">{{ model.real_name }}</div>
    </div>

    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Working Name</label>
        <div style="padding: 8px 0; font-weight: 500;">{{ model.working_name }}</div>
    </div>

    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Start Date</label>
        <div style="padding: 8px 0; font-weight: 500;">{{ model.start_date.strftime('%m/%d/%Y') if model.start_date else '—' }}</div>
    </div>

    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Payment Method</label>
        <div style="padding: 8px 0; font-weight: 500;">{{ model.payment_method }}</div>
    </div>

    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Payment Frequency</label>
        <div style="padding: 8px 0; font-weight: 500;">{{ model.payment_frequency|title }}</div>
    </div>

    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Monthly Amount (USD)</label>
        <div style="padding: 8px 0; font-weight: 500;">${{ '%.2f'|format(model.amount_monthly) }}</div>
    </div>

    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Crypto Wallet Address</label>
        <div style="padding: 8px 0; font-weight: 500;">{{ model.crypto_wallet if model.crypto_wallet else '—' }}</div>
    </div>
</section>

<section class="card" style="max-width: 820px;">
    <h2>Payment Summary</h2>
    
    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Total Paid (USD)</label>
        <div style="padding: 8px 0; font-weight: 500;">${{ '%.2f'|format(total_paid) }}</div>
    </div>

    <div class="form-row" style="background: rgba(51, 65, 85, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;">
        <label>Created</label>
        <div style="padding: 8px 0; font-weight: 500;">{{ model.created_at.strftime('%m/%d/%Y %I:%M %p') if model.created_at else '—' }}</div>
    </div>
</section>

<section class="card" style="max-width: 820px;">
    <div class="form-actions">
        {% if user.role == 'admin' %}
        <a class="button" href="/models/{{ model.id }}/edit">Edit Model</a>
        <button class="button secondary" type="button" onclick="if(confirm('Delete this model?')) { fetch('/models/{{ model.id }}/delete', { method: 'POST' }).then(() => window.location.href='/models'); }">Delete Model</button>
        {% endif %}
        <a class="button secondary" href="/models">Back to Roster</a>
    </div>
</section>

<section class="card" style="max-width: 820px; margin-top: 24px;">
    <h2>Payment History</h2>
    <p style="color: #cbd5e1; font-size: 0.95rem; margin-bottom: 16px;">Payment records from scheduled payroll runs.</p>
    
    {% if paid_payouts %}
    <div class="data-table-wrapper">
        <table class="data-table" style="font-size: 0.95rem;">
            <thead>
                <tr>
                    <th>Pay Date</th>
                    <th>Code</th>
                    <th>Working Name</th>
                    <th>Method</th>
                    <th>Frequency</th>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody>
                {% for payout in paid_payouts %}
                <tr>
                    <td>{{ payout.pay_date.strftime('%m/%d/%Y') }}</td>
                    <td style="font-weight: 600;">{{ payout.code }}</td>
                    <td>{{ payout.working_name }}</td>
                    <td>{{ payout.payment_method }}</td>
                    <td>{{ payout.payment_frequency|title }}</td>
                    <td style="font-weight: 600;">${{ '%.2f'|format(payout.amount) }}</td>
                    <td>
                        {% if payout.status == 'paid' %}
                            <span class="tag active" style="background: rgba(34, 197, 94, 0.2); color: #4ade80;">Paid</span>
                        {% elif payout.status == 'on_hold' %}
                            <span class="tag" style="background: rgba(234, 179, 8, 0.2); color: #facc15;">On Hold</span>
                        {% else %}
                            <span class="tag" style="background: rgba(107, 114, 128, 0.2); color: #9ca3af;">Not Paid</span>
                        {% endif %}
                    </td>
                    <td style="color: #cbd5e1; font-size: 0.9rem;">{{ payout.notes or '—' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div style="color: #cbd5e1; padding: 16px; text-align: center; background: rgba(51, 65, 85, 0.2); border-radius: 6px;">
        No paid payments recorded yet. View <a href="/schedules" style="color: #60a5fa; text-decoration: none; font-weight: 500;">Schedule Runs</a> to manage payments.
    </div>
    {% endif %}
</section>
{% endblock %}
